{'select date,flight,string_agg(airline::text,\',\') from (SELECT date,flight,airline, avg(departure_delay),  rank () over ( partition by date,flight order by avg(departure_delay) desc ) as rank FROM "date,departure_airport,flight,airline" WHERE airline in (\'UA\', \'VX\') group by date,flight,airline  ) t7 where (date,flight) in (select date,flight from (SELECT date,flight,airline FROM "date,departure_airport,flight,airline" WHERE airline in (\'UA\', \'VX\') group by date,flight,airline ) t group by date,flight having count(*) >1) group by date,flight;', 'select departure_airport,string_agg(airline::text,\',\') from (SELECT departure_airport,airline, avg(departure_delay),  rank () over ( partition by departure_airport order by avg(departure_delay) desc ) as rank FROM "departure_airport,flight,airline" WHERE airline in (\'UA\', \'VX\') group by departure_airport,airline  ) t7 where (departure_airport) in (select departure_airport from (SELECT departure_airport,airline FROM "departure_airport,flight,airline" WHERE airline in (\'UA\', \'VX\') group by departure_airport,airline ) t group by departure_airport having count(*) >1) group by departure_airport;', 'select date,departure_airport,departure_hour,string_agg(airline::text,\',\') from (SELECT date,departure_airport,departure_hour,airline, avg(departure_delay),  rank () over ( partition by date,departure_airport,departure_hour order by avg(departure_delay) desc ) as rank FROM "date,departure_airport,departure_hour,airline" WHERE airline in (\'UA\', \'VX\') group by date,departure_airport,departure_hour,airline  ) t7 where (date,departure_airport,departure_hour) in (select date,departure_airport,departure_hour from (SELECT date,departure_airport,departure_hour,airline FROM "date,departure_airport,departure_hour,airline" WHERE airline in (\'UA\', \'VX\') group by date,departure_airport,departure_hour,airline ) t group by date,departure_airport,departure_hour having count(*) >1) group by date,departure_airport,departure_hour;', 'select departure_hour,string_agg(airline::text,\',\') from (SELECT departure_hour,airline, avg(departure_delay),  rank () over ( partition by departure_hour order by avg(departure_delay) desc ) as rank FROM "departure_hour,airline" WHERE airline in (\'UA\', \'VX\') group by departure_hour,airline  ) t7 where (departure_hour) in (select departure_hour from (SELECT departure_hour,airline FROM "departure_hour,airline" WHERE airline in (\'UA\', \'VX\') group by departure_hour,airline ) t group by departure_hour having count(*) >1) group by departure_hour;',



'select flight,string_agg(airline::text,\',\') from (SELECT flight,airline, avg(departure_delay),  rank () over ( partition by flight order by avg(departure_delay) desc ) as rank FROM "flight,airline" WHERE airline in (\'WN\', \'VX\') group by flight,airline  ) t7 where (flight) in (select flight from (SELECT flight,airline FROM "flight,airline" WHERE airline in (\'WN\', \'VX\') group by flight,airline ) t group by flight having count(*) >1) group by flight;',




'select departure_airport,string_agg(airline::text,\',\') from (SELECT departure_airport,airline, avg(departure_delay),  rank () over ( partition by departure_airport order by avg(departure_delay) desc ) as rank FROM "departure_airport,flight,airline" WHERE airline in (\'WN\', \'VX\') group by departure_airport,airline  ) t7 where (departure_airport) in (select departure_airport from (SELECT departure_airport,airline FROM "departure_airport,flight,airline" WHERE airline in (\'WN\', \'VX\') group by departure_airport,airline ) t group by departure_airport having count(*) >1) group by departure_airport;', 'select date,departure_airport,flight,string_agg(airline::text,\',\') from (SELECT date,departure_airport,flight,airline, avg(departure_delay),  rank () over ( partition by date,departure_airport,flight order by avg(departure_delay) desc ) as rank FROM "date,departure_airport,flight,airline" WHERE airline in (\'WN\', \'VX\') group by date,departure_airport,flight,airline  ) t7 where (date,departure_airport,flight) in (select date,departure_airport,flight from (SELECT date,departure_airport,flight,airline FROM "date,departure_airport,flight,airline" WHERE airline in (\'WN\', \'VX\') group by date,departure_airport,flight,airline ) t group by date,departure_airport,flight having count(*) >1) group by date,departure_airport,flight;', 'select date,departure_airport,departure_hour,string_agg(airline::text,\',\') from (SELECT date,departure_airport,departure_hour,airline, avg(departure_delay),  rank () over ( partition by date,departure_airport,departure_hour order by avg(departure_delay) desc ) as rank FROM "date,departure_airport,departure_hour,airline" WHERE airline in (\'WN\', \'VX\') group by date,departure_airport,departure_hour,airline  ) t7 where (date,departure_airport,departure_hour) in (select date,departure_airport,departure_hour from (SELECT date,departure_airport,departure_hour,airline FROM "date,departure_airport,departure_hour,airline" WHERE airline in (\'WN\', \'VX\') group by date,departure_airport,departure_hour,airline ) t group by date,departure_airport,departure_hour having count(*) >1) group by date,departure_airport,departure_hour;', 'select date,departure_airport,string_agg(airline::text,\',\') from (SELECT date,departure_airport,airline, avg(departure_delay),  rank () over ( partition by date,departure_airport order by avg(departure_delay) desc ) as rank FROM "date,departure_airport,flight,airline" WHERE airline in (\'WN\', \'VX\') group by date,departure_airport,airline  ) t7 where (date,departure_airport) in (select date,departure_airport from (SELECT date,departure_airport,airline FROM "date,departure_airport,flight,airline" WHERE airline in (\'WN\', \'VX\') group by date,departure_airport,airline ) t group by date,departure_airport having count(*) >1) group by date,departure_airport;', 'select departure_airport,departure_hour,string_agg(airline::text,\',\') from (SELECT departure_airport,departure_hour,airline, avg(departure_delay),  rank () over ( partition by departure_airport,departure_hour order by avg(departure_delay) desc ) as rank FROM "date,departure_airport,departure_hour,airline" WHERE airline in (\'WN\', \'VX\') group by departure_airport,departure_hour,airline  ) t7 where (departure_airport,departure_hour) in (select departure_airport,departure_hour from (SELECT departure_airport,departure_hour,airline FROM "date,departure_airport,departure_hour,airline" WHERE airline in (\'WN\', \'VX\') group by departure_airport,departure_hour,airline ) t group by departure_airport,departure_hour having count(*) >1) group by departure_airport,departure_hour;', 'select departure_airport,flight,string_agg(airline::text,\',\') from (SELECT departure_airport,flight,airline, avg(departure_delay),  rank () over ( partition by departure_airport,flight order by avg(departure_delay) desc ) as rank FROM "departure_airport,flight,airline" WHERE airline in (\'WN\', \'VX\') group by departure_airport,flight,airline  ) t7 where (departure_airport,flight) in (select departure_airport,flight from (SELECT departure_airport,flight,airline FROM "departure_airport,flight,airline" WHERE airline in (\'WN\', \'VX\') group by departure_airport,flight,airline ) t group by departure_airport,flight having count(*) >1) group by departure_airport,flight;', 'select date,flight,string_agg(airline::text,\',\') from (SELECT date,flight,airline, avg(departure_delay),  rank () over ( partition by date,flight order by avg(departure_delay) desc ) as rank FROM "date,departure_airport,flight,airline" WHERE airline in (\'WN\', \'VX\') group by date,flight,airline  ) t7 where (date,flight) in (select date,flight from (SELECT date,flight,airline FROM "date,departure_airport,flight,airline" WHERE airline in (\'WN\', \'VX\') group by date,flight,airline ) t group by date,flight having count(*) >1) group by date,flight;', 'select departure_hour,string_agg(airline::text,\',\') from (SELECT departure_hour,airline, avg(departure_delay),  rank () over ( partition by departure_hour order by avg(departure_delay) desc ) as rank FROM "departure_hour,airline" WHERE airline in (\'WN\', \'VX\') group by departure_hour,airline  ) t7 where (departure_hour) in (select departure_hour from (SELECT departure_hour,airline FROM "departure_hour,airline" WHERE airline in (\'WN\', \'VX\') group by departure_hour,airline ) t group by departure_hour having count(*) >1) group by departure_hour;', 'select date,departure_hour,string_agg(airline::text,\',\') from (SELECT date,departure_hour,airline, avg(departure_delay),  rank () over ( partition by date,departure_hour order by avg(departure_delay) desc ) as rank FROM "date,departure_airport,departure_hour,airline" WHERE airline in (\'WN\', \'VX\') group by date,departure_hour,airline  ) t7 where (date,departure_hour) in (select date,departure_hour from (SELECT date,departure_hour,airline FROM "date,departure_airport,departure_hour,airline" WHERE airline in (\'WN\', \'VX\') group by date,departure_hour,airline ) t group by date,departure_hour having count(*) >1) group by date,departure_hour;', 'select \'all\',string_agg(airline::text,\',\') from (SELECT airline, avg(departure_delay),  rank () over (  order by avg(departure_delay) desc ) as rank FROM "airline" WHERE airline in (\'WN\', \'VX\') group by airline   order by rank);'}



'select departure_airport,flight,string_agg(airline::text,\',\') from (SELECT departure_airport,flight,airline, avg(departure_delay),  rank () over ( partition by departure_airport,flight order by avg(departure_delay) desc ) as rank FROM "departure_airport,flight,airline" WHERE airline in (\'UA\', \'VX\') group by departure_airport,flight,airline  ) t7 where (departure_airport,flight) in (select departure_airport,flight from (SELECT departure_airport,flight,airline FROM "departure_airport,flight,airline" WHERE airline in (\'UA\', \'VX\') group by departure_airport,flight,airline ) t group by departure_airport,flight having count(*) >1) group by departure_airport,flight;', 'select flight,string_agg(airline::text,\',\') from (SELECT flight,airline, avg(departure_delay),  rank () over ( partition by flight order by avg(departure_delay) desc ) as rank FROM "flight,airline" WHERE airline in (\'UA\', \'VX\') group by flight,airline  ) t7 where (flight) in (select flight from (SELECT flight,airline FROM "flight,airline" WHERE airline in (\'UA\', \'VX\') group by flight,airline ) t group by flight having count(*) >1) group by flight;', 'select date,departure_hour,string_agg(airline::text,\',\') from (SELECT date,departure_hour,airline, avg(departure_delay),  rank () over ( partition by date,departure_hour order by avg(departure_delay) desc ) as rank FROM "date,departure_airport,departure_hour,airline" WHERE airline in (\'UA\', \'VX\') group by date,departure_hour,airline  ) t7 where (date,departure_hour) in (select date,departure_hour from (SELECT date,departure_hour,airline FROM "date,departure_airport,departure_hour,airline" WHERE airline in (\'UA\', \'VX\') group by date,departure_hour,airline ) t group by date,departure_hour having count(*) >1) group by date,departure_hour;', 'select departure_airport,departure_hour,string_agg(airline::text,\',\') from (SELECT departure_airport,departure_hour,airline, avg(departure_delay),  rank () over ( partition by departure_airport,departure_hour order by avg(departure_delay) desc ) as rank FROM "date,departure_airport,departure_hour,airline" WHERE airline in (\'UA\', \'VX\') group by departure_airport,departure_hour,airline  ) t7 where (departure_airport,departure_hour) in (select departure_airport,departure_hour from (SELECT departure_airport,departure_hour,airline FROM "date,departure_airport,departure_hour,airline" WHERE airline in (\'UA\', \'VX\') group by departure_airport,departure_hour,airline ) t group by departure_airport,departure_hour having count(*) >1) group by departure_airport,departure_hour;', 'select \'all\',string_agg(airline::text,\',\') from (SELECT airline, avg(departure_delay),  rank () over (  order by avg(departure_delay) desc ) as rank FROM "airline" WHERE airline in (\'UA\', \'VX\') group by airline   order by rank);', 'select date,departure_airport,flight,string_agg(airline::text,\',\') from (SELECT date,departure_airport,flight,airline, avg(departure_delay),  rank () over ( partition by date,departure_airport,flight order by avg(departure_delay) desc ) as rank FROM "date,departure_airport,flight,airline" WHERE airline in (\'UA\', \'VX\') group by date,departure_airport,flight,airline  ) t7 where (date,departure_airport,flight) in (select date,departure_airport,flight from (SELECT date,departure_airport,flight,airline FROM "date,departure_airport,flight,airline" WHERE airline in (\'UA\', \'VX\') group by date,departure_airport,flight,airline ) t group by date,departure_airport,flight having count(*) >1) group by date,departure_airport,flight;', 'select date,departure_airport,string_agg(airline::text,\',\') from (SELECT date,departure_airport,airline, avg(departure_delay),  rank () over ( partition by date,departure_airport order by avg(departure_delay) desc ) as rank FROM "date,departure_airport,flight,airline" WHERE airline in (\'UA\', \'VX\') group by date,departure_airport,airline  ) t7 where (date,departure_airport) in (select date,departure_airport from (SELECT date,departure_airport,airline FROM "date,departure_airport,flight,airline" WHERE airline in (\'UA\', \'VX\') group by date,departure_airport,airline ) t group by date,departure_airport having count(*) >1) group by date,departure_airport;'}



'select date,string_agg(airline::text,\',\') from (SELECT date,airline, avg(departure_delay),  rank () over ( partition by date order by avg(departure_delay) desc ) as rank FROM "date,departure_airport,flight,airline" WHERE airline in (\'WN\', \'VX\') group by date,airline  ) t7 where (date) in (select date from (SELECT date,airline FROM "date,departure_airport,flight,airline" WHERE airline in (\'WN\', \'VX\') group by date,airline ) t group by date having count(*) >1) group by date;',
'select date,string_agg(airline::text,\',\') from (SELECT date,airline, avg(departure_delay),  rank () over ( partition by date order by avg(departure_delay) desc ) as rank FROM "date,departure_airport,flight,airline" WHERE airline in (\'UA\', \'VX\') group by date,airline  ) t7 where (date) in (select date from (SELECT date,airline FROM "date,departure_airport,flight,airline" WHERE airline in (\'UA\', \'VX\') group by date,airline ) t group by date having count(*) >1) group by date;',
